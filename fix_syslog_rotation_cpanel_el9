#!/bin/bash

# File to check
FILE="/etc/logrotate.d/syslog"

# Check if the file already exists
if [ -e "$FILE" ]; then
    echo "syslog file already exists"
    exit 0
else
    # Create the file with the specified content
    cat <<EOF >"$FILE"
{
    missingok
    sharedscripts
    postrotate
        /bin/kill -HUP \`cat /var/run/syslogd.pid 2> /dev/null\` 2> /dev/null || true
    endscript
}
EOF
    echo "syslog file created successfully"
    
    # Ask if the user wants to run logrotate
    read -p "Do you want to run logrotate for the new syslog file now? [y/N]: " response
    response=${response,,} # Convert to lowercase for consistency
    
    if [[ "$response" == "y" ]]; then
        # Run logrotate for the syslog file
        logrotate -f "$FILE"
        if [ $? -eq 0 ]; then
            echo "logrotate ran successfully for $FILE"
        else
            echo "Failed to run logrotate for $FILE"
        fi
    else
        echo "Skipping logrotate for $FILE"
    fi
    exit 0
fi
